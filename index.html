<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Split-Flap Clock</title>
    <style>
        /* --- CSS Reset & Base --- */
        * {
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        body {
            height: 100vh;
            width: 100%;
            overflow: hidden;
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            background-color: #111;
        }

        /* --- Dynamic Background Layer --- */
        #bg-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background-size: cover;
            background-position: center;
            /* Default Background: Soft Gradient */
            background-image: -webkit-radial-gradient(center, ellipse cover, #eef2f3 0%, #8e9eab 100%);
            /* Transition for blur effect */
            -webkit-transition: -webkit-filter 0.5s;
            transition: filter 0.5s;
        }

        /* Overlay to ensure text contrast */
        #overlay-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            background: rgba(0,0,0,0.1);
        }

        /* --- Main Clock Container --- */
        .clock-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            align-items: center;
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            justify-content: center;
            /* Scale transform will be applied via JS for responsiveness */
            -webkit-transform-origin: center center;
            transform-origin: center center;
        }

        .clock-group {
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            padding: 20px;
        }

        /* --- The Split Flap Card --- */
        .card {
            position: relative;
            width: 140px; /* Base width */
            height: 210px; /* Base height */
            margin: 0 8px;
            background-color: #2b2b2b;
            border-radius: 10px;
            box-shadow: 
                0 4px 0 #1a1a1a, 
                0 15px 35px -5px rgba(0,0,0,0.5),
                inset 0 1px 1px rgba(255,255,255,0.15);
        }

        /* Seconds card slightly smaller or distinct? 
           User asked for "Minimalist", keeping same height is cleaner, 
           maybe slightly narrower or just same to keep rhythm. 
           Let's keep them uniform for "Matte Charcoal" look. */

        /* Label 12/24 / AM/PM */
        .card-label {
            position: absolute;
            top: 10px;
            left: 12px;
            font-size: 9px;
            color: #777;
            font-weight: bold;
            letter-spacing: 1px;
            z-index: 20;
            text-transform: uppercase;
        }

        .digit-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            overflow: hidden;
        }

        /* Half Styling */
        .half {
            position: absolute;
            left: 0;
            width: 100%;
            height: 50%;
            overflow: hidden;
            background-color: #2b2b2b;
        }

        .top {
            top: 0;
            border-radius: 10px 10px 0 0;
            background: -webkit-linear-gradient(top, #3a3a3a 0%, #2b2b2b 100%);
            border-bottom: 1px solid #151515;
        }

        .bottom {
            bottom: 0;
            border-radius: 0 0 10px 10px;
            background: -webkit-linear-gradient(top, #2b2b2b 0%, #353535 100%);
            border-top: 1px solid #444;
        }

        /* Number Typography */
        .number {
            font-weight: 700;
            font-size: 120px; /* Default size */
            color: #e6e6e6;
            line-height: 210px; /* Matches card height */
            position: absolute;
            left: 0;
            right: 0;
            width: 100%;
            text-align: center;
            letter-spacing: -3px;
            -webkit-transition: font-size 0.3s ease;
            transition: font-size 0.3s ease;
        }

        .top .number { top: 0; }
        .bottom .number { top: -105px; /* Half of card height */ }

        /* Hinges */
        .hinge {
            position: absolute;
            top: 50%;
            width: 4px;
            height: 10px;
            background: #111;
            margin-top: -5px;
            border-radius: 2px;
            z-index: 15;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.1);
        }
        .hinge.left { left: -2px; }
        .hinge.right { right: -2px; }

        /* --- Settings Panel (Bottom Right) --- */
        #settings-trigger {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(43, 43, 43, 0.6);
            z-index: 100;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: -webkit-box;
            display: flex;
            -webkit-box-align: center;
            align-items: center;
            -webkit-box-pack: center;
            justify-content: center;
            -webkit-transition: background 0.3s;
        }
        
        /* Gear Icon (Pure CSS) */
        .gear {
            width: 20px;
            height: 20px;
            border: 2px solid #fff;
            border-radius: 50%;
            position: relative;
        }
        .gear:after {
            content: '';
            position: absolute;
            top: 3px; left: 3px;
            width: 10px; height: 10px;
            background: #fff;
            border-radius: 50%;
        }

        #settings-menu {
            position: absolute;
            bottom: 70px;
            right: 20px;
            width: 200px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 15px;
            z-index: 99;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            
            /* Hidden state */
            opacity: 0;
            pointer-events: none;
            -webkit-transform: translateY(10px);
            transform: translateY(10px);
            -webkit-transition: all 0.3s ease;
            transition: all 0.3s ease;
        }

        #settings-menu.active {
            opacity: 1;
            pointer-events: auto;
            -webkit-transform: translateY(0);
            transform: translateY(0);
        }

        /* Settings Items */
        .setting-row {
            margin-bottom: 12px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .setting-row:last-child {
            border: none;
            margin: 0;
            padding: 0;
        }
        .setting-label {
            font-size: 12px;
            color: #333;
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }
        
        .btn-group {
            display: -webkit-box;
            display: flex;
            gap: 5px;
        }

        .btn {
            -webkit-box-flex: 1;
            flex: 1;
            padding: 8px;
            font-size: 11px;
            text-align: center;
            background: #f0f0f0;
            border-radius: 6px;
            color: #333;
            cursor: pointer;
            border: 1px solid #ddd;
        }
        .btn:active { background: #ddd; }
        .btn.active-mode { background: #333; color: #fff; border-color: #333; }

    </style>
</head>
<body>

    <!-- Background Layer (Blurred via JS/CSS) -->
    <div id="bg-layer"></div>
    <div id="overlay-layer"></div>

    <!-- Clock Display -->
    <div class="clock-wrapper" id="clock-wrapper">
        <div class="clock-group">
            
            <!-- Hour -->
            <div class="card">
                <div class="hinge left"></div><div class="hinge right"></div>
                <div class="card-label" id="ampm-label">24H</div>
                <div class="digit-container">
                    <div class="half top"><div class="number" id="h-top">12</div></div>
                    <div class="half bottom"><div class="number" id="h-bottom">12</div></div>
                </div>
            </div>

            <!-- Minute -->
            <div class="card">
                <div class="hinge left"></div><div class="hinge right"></div>
                <div class="digit-container">
                    <div class="half top"><div class="number" id="m-top">00</div></div>
                    <div class="half bottom"><div class="number" id="m-bottom">00</div></div>
                </div>
            </div>

            <!-- Second (The "Hand" equivalent) -->
            <div class="card">
                <div class="hinge left"></div><div class="hinge right"></div>
                <div class="digit-container">
                    <div class="half top"><div class="number" id="s-top">00</div></div>
                    <div class="half bottom"><div class="number" id="s-bottom">00</div></div>
                </div>
            </div>

        </div>
    </div>

    <!-- Settings Controls -->
    <div id="settings-trigger">
        <div class="gear"></div>
    </div>

    <div id="settings-menu">
        <!-- 12/24 Toggle -->
        <div class="setting-row">
            <span class="setting-label">时间格式 (Format)</span>
            <div class="btn-group">
                <div class="btn" id="btn-12h" onclick="setFormat(12)">12H</div>
                <div class="btn active-mode" id="btn-24h" onclick="setFormat(24)">24H</div>
            </div>
        </div>

        <!-- Size Control -->
        <div class="setting-row">
            <span class="setting-label">数字大小 (Size)</span>
            <div class="btn-group">
                <div class="btn" onclick="adjustSize(-10)">-</div>
                <div class="btn" onclick="adjustSize(10)">+</div>
            </div>
        </div>

        <!-- Wallpaper -->
        <div class="setting-row">
            <span class="setting-label">壁纸效果 (Wallpaper)</span>
            <div class="btn-group">
                <div class="btn" onclick="cycleBg()">换图</div>
                <div class="btn" id="btn-blur" onclick="toggleBlur()">磨砂</div>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration State ---
        var is24Hour = true;
        var currentSize = 120; // Default font size
        var isBlurred = false;
        var bgIndex = 0;
        
        // Background presets (Hosted placeholder images or CSS gradients)
        var backgrounds = [
            'linear-gradient(to bottom right, #eef2f3, #8e9eab)', // Light Gray
            'linear-gradient(to bottom right, #232526, #414345)', // Dark
            'linear-gradient(to bottom right, #A7BFE8, #6190E8)', // Soft Blue
            'linear-gradient(to bottom right, #ff9966, #ff5e62)'  // Sunset
        ];

        // --- DOM Elements ---
        var menu = document.getElementById('settings-menu');
        var trigger = document.getElementById('settings-trigger');
        var bgLayer = document.getElementById('bg-layer');
        var amPmLabel = document.getElementById('ampm-label');

        // --- Clock Logic ---
        function updateClock() {
            var now = new Date();
            var h = now.getHours();
            var m = now.getMinutes();
            var s = now.getSeconds();
            
            var displayH = h;
            var amPmText = "";

            if (!is24Hour) {
                amPmText = h >= 12 ? "PM" : "AM";
                displayH = h % 12;
                if (displayH === 0) displayH = 12;
                amPmLabel.innerHTML = amPmText;
            } else {
                amPmLabel.innerHTML = "24H";
            }

            // Helpers
            function pad(n) { return n < 10 ? '0' + n : n; }
            function setVal(id, val) { document.getElementById(id).innerHTML = val; }

            var hStr = pad(displayH);
            var mStr = pad(m);
            var sStr = pad(s);

            setVal('h-top', hStr); setVal('h-bottom', hStr);
            setVal('m-top', mStr); setVal('m-bottom', mStr);
            setVal('s-top', sStr); setVal('s-bottom', sStr);
        }

        setInterval(updateClock, 1000);
        updateClock();

        // --- UI Logic ---

        // Toggle Menu
        trigger.addEventListener('click', function(e) {
            // Toggle class for active
            if (menu.className.indexOf('active') === -1) {
                menu.className += ' active';
            } else {
                menu.className = menu.className.replace(' active', '');
            }
            e.stopPropagation();
        });

        // Close menu when clicking outside
        document.body.addEventListener('click', function() {
            menu.className = menu.className.replace(' active', '');
        });

        // Stop propagation inside menu
        menu.addEventListener('click', function(e) {
            e.stopPropagation();
        });

        // 12/24 Format
        function setFormat(mode) {
            if (mode === 24) {
                is24Hour = true;
                document.getElementById('btn-24h').className = 'btn active-mode';
                document.getElementById('btn-12h').className = 'btn';
            } else {
                is24Hour = false;
                document.getElementById('btn-24h').className = 'btn';
                document.getElementById('btn-12h').className = 'btn active-mode';
            }
            updateClock();
        }

        // Adjust Size (Font Size & Scale)
        function adjustSize(delta) {
            currentSize += delta;
            if (currentSize < 60) currentSize = 60;
            if (currentSize > 180) currentSize = 180;

            // Apply to all number elements
            var nums = document.querySelectorAll('.number');
            for (var i = 0; i < nums.length; i++) {
                nums[i].style.fontSize = currentSize + 'px';
            }
        }

        // Toggle Wallpaper Blur
        function toggleBlur() {
            isBlurred = !isBlurred;
            var btn = document.getElementById('btn-blur');
            if (isBlurred) {
                bgLayer.style.webkitFilter = "blur(15px)";
                bgLayer.style.filter = "blur(15px)";
                // Scale up slightly to hide white blurred edges
                bgLayer.style.webkitTransform = "scale(1.1)"; 
                bgLayer.style.transform = "scale(1.1)";
                btn.className = "btn active-mode";
            } else {
                bgLayer.style.webkitFilter = "none";
                bgLayer.style.filter = "none";
                bgLayer.style.webkitTransform = "scale(1)";
                bgLayer.style.transform = "scale(1)";
                btn.className = "btn";
            }
        }

        // Cycle Backgrounds
        function cycleBg() {
            bgIndex++;
            if (bgIndex >= backgrounds.length) bgIndex = 0;
            bgLayer.style.backgroundImage = backgrounds[bgIndex];
        }

        // --- Responsiveness for Small Screens (iPhone 4s) ---
        // Automatically scale the clock down if the window is too narrow
        function handleResize() {
            var width = window.innerWidth;
            var clock = document.getElementById('clock-wrapper');
            var scale = 1;

            if (width < 500) {
                scale = width / 500; // Calculate ratio
            }
            
            // Apply scale to the wrapper's inner group via transform
            // We apply it to .clock-group to keep center alignment
            var group = document.querySelector('.clock-group');
            group.style.webkitTransform = 'scale(' + scale + ')';
            group.style.transform = 'scale(' + scale + ')';
        }

        window.addEventListener('resize', handleResize);
        handleResize(); // Init

    </script>
</body>
</html>